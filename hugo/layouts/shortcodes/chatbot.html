API: {{ .Get "api" }}

Ask a question:
<input type="textarea" id="chatbot_user_message" autocomplete="off" />
<br />

<p>Assistant response:</p>
<input type="textarea" id="chatbot_assistant_message" autocomplete="off" readonly="true" />
<br />

<script>
    const API_URL = 'https://uz0k9wxh33.execute-api.ca-central-1.amazonaws.com/live';

    const userMessageTextInput = document.getElementById('chatbot_user_message');
    const assistantMessageTextInput = document.getElementById('chatbot_assistant_message');

    const handleAssistantMessage = (assistantMessage) => {
        console.log(`Assistant message: ${assistantMessage}`)
        const assistantMessageObject = JSON.parse(assistantMessage);
        assistantMessageTextInput.value = assistantMessageObject.text;
    }

    const submitUserMessage = (message) => {
        console.log('submitMessage', message);
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                const assistantMessage = xmlHttp.responseText;
                handleAssistantMessage(assistantMessage);
            }
        }
        const conversationId = '123'; // TODO
        const isAsynchronous = true;
        xmlHttp.open('POST', `${API_URL}/chatbot/conversation/${conversationId}`, isAsynchronous);
        xmlHttp.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
        xmlHttp.send(JSON.stringify({
            'text': message,
        }));
    };

    userMessageTextInput.addEventListener('keypress', (event) => {
        if (event.key !== 'Enter') return;
        event.preventDefault();
        const message = event.target.value;
        submitUserMessage(message);
    });
</script>
